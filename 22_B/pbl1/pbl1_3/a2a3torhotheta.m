function [sol_r,sol_theta] = a2a3torhotheta(a2,a3,theta_n,r)
% sol_r = [-(r*sin(a3 - theta_n)*sqrt(-(cos(4*a2 + 2*a3 + 2*theta_n) + 6*cos(2*a2 + 2*a3) + 6*cos(2*a2 + 2*theta_n) + cos(2*a3 - 2*theta_n) + 16*cos(2*a2 + a3 + theta_n) + 24*cos(a2 + a3) + 24*cos(a2 + theta_n) + 4*cos(a2 - a3 + 2*theta_n) + 4*cos(a2 + 2*a3 - theta_n) + 4*cos(3*a2 + a3 + 2*theta_n) + 4*cos(3*a2 + 2*a3 + theta_n) + 16*cos(a3 - theta_n) + 18)/(cos(2*a2) - cos(2*a2 + 2*a3 - theta_n) + cos(2*a2 + 2*a3) + cos(2*a3 - theta_n) + cos(theta_n) - cos(2*a2 + theta_n) - 2)))/(cos(2*a2 + a3 + theta_n) + 2*cos(a2 + a3) + 2*cos(a2 + theta_n) + cos(a3 - theta_n) + 2); (r*sin(a3 - theta_n)*sqrt(-(cos(4*a2 + 2*a3 + 2*theta_n) + 6*cos(2*a2 + 2*a3) + 6*cos(2*a2 + 2*theta_n) + cos(2*a3 - 2*theta_n) + 16*cos(2*a2 + a3 + theta_n) + 24*cos(a2 + a3) + 24*cos(a2 + theta_n) + 4*cos(a2 - a3 + 2*theta_n) + 4*cos(a2 + 2*a3 - theta_n) + 4*cos(3*a2 + a3 + 2*theta_n) + 4*cos(3*a2 + 2*a3 + theta_n) + 16*cos(a3 - theta_n) + 18)/(cos(2*a2) - cos(2*a2 + 2*a3 - theta_n) + cos(2*a2 + 2*a3) + cos(2*a3 - theta_n) + cos(theta_n) - cos(2*a2 + theta_n) - 2)))/(cos(2*a2 + a3 + theta_n) + 2*cos(a2 + a3) + 2*cos(a2 + theta_n) + cos(a3 - theta_n) + 2)];
% sol_theta = [-(r*sin(a3 - theta_n)*sqrt(-(cos(4*a2 + 2*a3 + 2*theta_n) + 6*cos(2*a2 + 2*a3) + 6*cos(2*a2 + 2*theta_n) + cos(2*a3 - 2*theta_n) + 16*cos(2*a2 + a3 + theta_n) + 24*cos(a2 + a3) + 24*cos(a2 + theta_n) + 4*cos(a2 - a3 + 2*theta_n) + 4*cos(a2 + 2*a3 - theta_n) + 4*cos(3*a2 + a3 + 2*theta_n) + 4*cos(3*a2 + 2*a3 + theta_n) + 16*cos(a3 - theta_n) + 18)/(cos(2*a2) - cos(2*a2 + 2*a3 - theta_n) + cos(2*a2 + 2*a3) + cos(2*a3 - theta_n) + cos(theta_n) - cos(2*a2 + theta_n) - 2)))/(cos(2*a2 + a3 + theta_n) + 2*cos(a2 + a3) + 2*cos(a2 + theta_n) + cos(a3 - theta_n) + 2); (r*sin(a3 - theta_n)*sqrt(-(cos(4*a2 + 2*a3 + 2*theta_n) + 6*cos(2*a2 + 2*a3) + 6*cos(2*a2 + 2*theta_n) + cos(2*a3 - 2*theta_n) + 16*cos(2*a2 + a3 + theta_n) + 24*cos(a2 + a3) + 24*cos(a2 + theta_n) + 4*cos(a2 - a3 + 2*theta_n) + 4*cos(a2 + 2*a3 - theta_n) + 4*cos(3*a2 + a3 + 2*theta_n) + 4*cos(3*a2 + 2*a3 + theta_n) + 16*cos(a3 - theta_n) + 18)/(cos(2*a2) - cos(2*a2 + 2*a3 - theta_n) + cos(2*a2 + 2*a3) + cos(2*a3 - theta_n) + cos(theta_n) - cos(2*a2 + theta_n) - 2)))/(cos(2*a2 + a3 + theta_n) + 2*cos(a2 + a3) + 2*cos(a2 + theta_n) + cos(a3 - theta_n) + 2)];
sol_r = [-2*r*(tan(a2/2 + a3/2) - tan(a2/2 + theta_n/2))*(tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + 1)*sqrt(1/((tan(a2/2 + theta_n/2)^2 + 1)*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2))); 2*r*(tan(a2/2 + a3/2) - tan(a2/2 + theta_n/2))*(tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + 1)*sqrt(1/((tan(a2/2 + theta_n/2)^2 + 1)*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2)))];
sol_theta = [2*atan((sin(a2)*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 + sin(a2)*tan(a2/2 + a3/2)^2 - 2*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2 + 2*tan(a2/2 + a3/2) - sin(a2)*tan(a2/2 + theta_n/2)^2 - sin(a2))/(2*(tan(a2/2 + a3/2)*sin(a2)*tan(a2/2 + theta_n/2)^2 - 2*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + tan(a2/2 + a3/2)*sin(a2))) + (r*(tan(a2/2 + a3/2) - tan(a2/2 + theta_n/2))*(tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + 1)*sqrt(1/((tan(a2/2 + theta_n/2)^2 + 1)*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2)))*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 2*tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^4*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^3*sin(a2) + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 8*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^4*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2))/(2*(r*sin(a2)*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^3 - 2*r*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2 + r*sin(a2)*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2) - r*sin(a2)*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4 + 2*r*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^3 - 2*r*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2) + r*sin(a2)*tan(a2/2 + a3/2)^2 - r*sin(a2)*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^3 + 2*r*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2 - r*sin(a2)*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)))); 2*atan((sin(a2)*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 + sin(a2)*tan(a2/2 + a3/2)^2 - 2*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2 + 2*tan(a2/2 + a3/2) - sin(a2)*tan(a2/2 + theta_n/2)^2 - sin(a2))/(2*(tan(a2/2 + a3/2)*sin(a2)*tan(a2/2 + theta_n/2)^2 - 2*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + tan(a2/2 + a3/2)*sin(a2))) - (r*(tan(a2/2 + a3/2) - tan(a2/2 + theta_n/2))*(tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2) + 1)*sqrt(1/((tan(a2/2 + theta_n/2)^2 + 1)*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2)))*(tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 2*tan(a2/2 + a3/2)^4*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + tan(a2/2 + a3/2)^4*sin(a2)^2 - 4*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^4*sin(a2) + 4*tan(a2/2 + a3/2)^3*sin(a2) + 2*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^3*sin(a2) + 4*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + 8*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^2 - 16*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)*sin(a2) + 2*tan(a2/2 + a3/2)^2*sin(a2)^2 + 4*tan(a2/2 + a3/2)^2 + 4*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^4*sin(a2) - 4*tan(a2/2 + a3/2)*sin(a2) + tan(a2/2 + theta_n/2)^4*sin(a2)^2 + 2*tan(a2/2 + theta_n/2)^2*sin(a2)^2 + sin(a2)^2))/(2*(r*sin(a2)*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^3 - 2*r*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2)^2 + r*sin(a2)*tan(a2/2 + a3/2)^3*tan(a2/2 + theta_n/2) - r*sin(a2)*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^4 + 2*r*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2)^3 - 2*r*tan(a2/2 + a3/2)^2*tan(a2/2 + theta_n/2) + r*sin(a2)*tan(a2/2 + a3/2)^2 - r*sin(a2)*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^3 + 2*r*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2)^2 - r*sin(a2)*tan(a2/2 + a3/2)*tan(a2/2 + theta_n/2))))];
% idx_r = sol_r>0;
% idx_theta = sol_theta>0;
% sol_r = sol_r(idx_r);
% sol_theta = sol_theta(idx_theta);
sol_r = sol_r(1);
sol_theta = sol_theta(1);
end